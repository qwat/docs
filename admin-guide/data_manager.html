<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.1. Data manager &mdash; QWAT 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.2. Triggers" href="triggers.html" />
    <link rel="prev" title="4. Admin Guide" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> QWAT
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features-guide/index.html">1. QWAT / TEKSI drinking water module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation-guide/index.html">2. QWAT Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/index.html">3. QWAT User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">4. Admin Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.1. Data manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-data-to-qwat">4.1.1. Import data to QWAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-data-from-topobase">4.1.2. Import data from Topobase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#export-data-to-interlis-sia-405-format">4.1.3. Export data to INTERLIS SIA 405 format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage">4.1.3.1. Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limitations">4.1.3.2. Limitations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#export-data-to-sire">4.1.4. Export data to SIRE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backup-data">4.1.5. Backup data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restoring-data">4.1.6. Restoring data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qwat-analysis-tools">4.1.7. QWAT analysis tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="triggers.html">4.2. Triggers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide/index.html">5. Contributor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer-guide/index.html">6. Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demo-guide/index.html">7. Demo data and project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">8. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary/index.html">9. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../translation/index.html">10. Translation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QWAT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">4. </span>Admin Guide</a> &raquo;</li>
      <li><span class="section-number">4.1. </span>Data manager</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/admin-guide/data_manager.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-manager">
<h1><span class="section-number">4.1. </span>Data manager<a class="headerlink" href="#data-manager" title="Permalink to this headline"></a></h1>
<section id="import-data-to-qwat">
<h2><span class="section-number">4.1.1. </span>Import data to QWAT<a class="headerlink" href="#import-data-to-qwat" title="Permalink to this headline"></a></h2>
<p>It is generally prefered to load QWAT data trough the views and not the tables, given the complexity of object model, and the business intelligence located in the edit triggers. (e.g. node and topology handling).</p>
<p>A [nice alternative technique](<a class="reference external" href="mailto:git&#37;&#52;&#48;github&#46;com">git<span>&#64;</span>github<span>&#46;</span>com</a>:nliaudat/qwat-import-sample.git) is proposed by Nicolas Liaudat, that uses directly QGIS and expressions to load datasets. Please contribute to it if you find enhancements of issues.</p>
</section>
<section id="import-data-from-topobase">
<h2><span class="section-number">4.1.2. </span>Import data from Topobase<a class="headerlink" href="#import-data-from-topobase" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>describe the process and tools</p></li>
<li><p>describe the automated and manual checks to do</p></li>
<li><p>mention specific point of attention</p></li>
</ul>
</section>
<section id="export-data-to-interlis-sia-405-format">
<h2><span class="section-number">4.1.3. </span>Export data to INTERLIS SIA 405 format<a class="headerlink" href="#export-data-to-interlis-sia-405-format" title="Permalink to this headline"></a></h2>
<p>Exporting a QWAT database to the Interlis Exchange Format (.xtf) is possible using the dedicated
tool <a class="reference external" href="https://github.com/QGEP/qgepqwat2ili">qgepqwat2ili</a> developped as part of an NGDI project.</p>
<section id="usage">
<h3><span class="section-number">4.1.3.1. </span>Usage<a class="headerlink" href="#usage" title="Permalink to this headline"></a></h3>
<p>Qgepqwat2ili requires Java (JRE 1.6 or above) and python (3.6 or above).</p>
<p>Then, it can be installed like any other python library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">qgepqwat2ili</span>
</pre></div>
</div>
<p>A simple export is done like this (assuming you have a pgservice defined named <cite>qwat</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">qgepqwat2ili</span> <span class="n">qwat</span> <span class="n">export</span> <span class="n">desktop</span><span class="o">/</span><span class="n">my_export</span><span class="o">.</span><span class="n">xtf</span>
</pre></div>
</div>
<p>Full usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">qgepqwat2ili</span> <span class="n">qwat</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">recreate_schema</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">skip_validation</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">pgservice</span> <span class="n">PGSERVICE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">log</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">include_hydraulics</span><span class="p">]</span> <span class="n">export</span> <span class="n">path</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="p">{</span><span class="n">import</span><span class="p">,</span><span class="n">export</span><span class="p">}</span>       <span class="kn">import</span> <span class="nn">is</span> <span class="n">currently</span> <span class="ow">not</span> <span class="n">supported</span>
<span class="n">path</span>                  <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">input</span><span class="o">/</span><span class="n">output</span> <span class="o">.</span><span class="n">xtf</span> <span class="n">file</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">--</span><span class="n">recreate_schema</span>     <span class="n">drops</span> <span class="n">schema</span> <span class="ow">and</span> <span class="n">reruns</span> <span class="n">ili2pg</span> <span class="n">importschema</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">--</span><span class="n">skip_validation</span>     <span class="n">skips</span> <span class="n">running</span> <span class="n">ilivalidator</span> <span class="n">on</span> <span class="nb">input</span><span class="o">/</span><span class="n">output</span> <span class="n">xtf</span> <span class="p">(</span><span class="n">required</span> <span class="n">to</span> <span class="kn">import</span> <span class="nn">invalid</span> <span class="n">files</span><span class="p">,</span> <span class="n">invalid</span> <span class="n">outputs</span> <span class="n">are</span> <span class="n">still</span> <span class="n">generated</span><span class="p">)</span>
                        <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">--</span><span class="n">include_hydraulics</span>  <span class="k">if</span> <span class="n">provided</span><span class="p">,</span> <span class="n">exports</span> <span class="n">will</span> <span class="n">include</span> <span class="n">hydraulischer_strang</span> <span class="ow">and</span> <span class="n">hydraulischer_node</span> <span class="n">classes</span> <span class="p">(</span><span class="n">these</span> <span class="n">are</span> <span class="n">currently</span> <span class="n">likely</span> <span class="n">to</span> <span class="n">make</span> <span class="n">the</span> <span class="n">export</span> <span class="n">invalid</span> <span class="n">due</span> <span class="n">to</span> <span class="n">issues</span> <span class="k">with</span> <span class="n">the</span> <span class="n">current</span> <span class="n">ili</span> <span class="n">model</span><span class="p">)</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">--</span><span class="n">pgservice</span> <span class="n">PGSERVICE</span>
                        <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pgservice</span> <span class="n">to</span> <span class="n">use</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">database</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">qwat</span><span class="p">)</span>
<span class="o">--</span><span class="n">log</span>                 <span class="n">saves</span> <span class="n">a</span> <span class="n">log</span> <span class="n">file</span> <span class="nb">next</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">input</span><span class="o">/</span><span class="n">output</span> <span class="n">file</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Further documentation as well as an issue tracker can be found on the <a class="reference external" href="https://github.com/QGEP/qgepqwat2ili">qgepqwat2ili repository</a>.</p>
</section>
<section id="limitations">
<h3><span class="section-number">4.1.3.2. </span>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline"></a></h3>
<p>The tool is currently experimental. Please be aware of the following limitations:</p>
<ul class="simple">
<li><p>The tool has not yet been tested much with actual data.</p></li>
<li><p>The QWAT datamodel and the SIA 405 datamodel have some important differences. Thus, not all classes or properties
can be matched precisely.</p></li>
<li><p>By default, the tool does not export hydraulic classes. An option must explicitely be added to do so, but this will
result to invalid files, due to differences mentionned above.</p></li>
<li><p>The tool is currently only available as a command line tool. It will at some point be embedded in the QWAT plugin,
similarly to what was done for QGEP.</p></li>
<li><p>The tool currently supports only export. Supporting imports is planned, but this require larger changes to bring the
QWAT datamodel closer to the SIA405 norm.</p></li>
</ul>
<p>Make sure that you carefully review the resulting data, and ensure you are getting expected results before distributing
your files. Also please report any error or inconsistencies that you are getting on the
<a class="reference external" href="https://github.com/QGEP/qgepqwat2ili/issues">qgepqwat2ili issue tracker</a> to help improving the tool.</p>
</section>
</section>
<section id="export-data-to-sire">
<h2><span class="section-number">4.1.4. </span>Export data to SIRE<a class="headerlink" href="#export-data-to-sire" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>describe the process and tools</p></li>
<li><p>describe the automated and manual checks to do</p></li>
<li><p>mention specific point of attention</p></li>
</ul>
</section>
<section id="backup-data">
<h2><span class="section-number">4.1.5. </span>Backup data<a class="headerlink" href="#backup-data" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Use PostgreSQL backups</p></li>
<li><p>points of attention (PG versions…)</p></li>
</ul>
</section>
<section id="restoring-data">
<h2><span class="section-number">4.1.6. </span>Restoring data<a class="headerlink" href="#restoring-data" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Use PostgreSQL backups</p></li>
<li><p>points of attention</p></li>
</ul>
</section>
<section id="qwat-analysis-tools">
<h2><span class="section-number">4.1.7. </span>QWAT analysis tools<a class="headerlink" href="#qwat-analysis-tools" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Where to find data analysis scripts</p></li>
<li><p>How to use them</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="4. Admin Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="triggers.html" class="btn btn-neutral float-right" title="4.2. Triggers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, QWAT team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>