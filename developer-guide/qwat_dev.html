<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6.1. QWAT Development Overview &mdash; QWAT 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2. Customize local DB models" href="local_customizations.html" />
    <link rel="prev" title="6. Developer’s guide" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            QWAT
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features-guide/index.html">1. QWAT / TEKSI drinking water module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation-guide/index.html">2. QWAT Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide/index.html">3. QWAT User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">4. Admin Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide/index.html">5. Contributor’s guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">6. Developer’s guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.1. QWAT Development Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">6.1.1. Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment">6.1.2. Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qwat-architecture">6.1.3. QWAT architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#roles">6.1.4. Roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#release-cycles-and-versioning">6.1.5. Release cycles and versioning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#version-and-release-management-policy">6.1.5.1. Version and release management policy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#release-process">6.1.6. Release process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-dependencies">6.1.7. Additional dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#versioning-your-extensions">6.1.8. Versioning your extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developing-the-core-data-model">6.1.9. Developing the core data model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developing-a-qgis-project">6.1.10. Developing a QGIS project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-new-features-to-qwat">6.1.11. Adding new features to QWAT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="local_customizations.html">6.2. Customize local DB models</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_customizations.html#create-an-extension">6.3. Create an extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">6.4. Upgrade database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../demo-guide/index.html">7. Demo data and project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">8. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary/index.html">9. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../translation/index.html">10. Translation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QWAT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">6. </span>Developer’s guide</a></li>
      <li class="breadcrumb-item active"><span class="section-number">6.1. </span>QWAT Development Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developer-guide/qwat_dev.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qwat-development-overview">
<h1><span class="section-number">6.1. </span>QWAT Development Overview<a class="headerlink" href="#qwat-development-overview" title="Permalink to this heading"></a></h1>
<section id="prerequisites">
<h2><span class="section-number">6.1.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h2>
<p>In order to develop for QWAT, the following skills may be required :</p>
<ul class="simple">
<li><p>Good general knowledge of GIS</p></li>
<li><p>Good general knowledge of QGIS</p></li>
<li><p>Skills in relational databases and PostgreSQL/PostGIS specifically</p></li>
<li><p>Skills in Python</p></li>
</ul>
</section>
<section id="environment">
<h2><span class="section-number">6.1.2. </span>Environment<a class="headerlink" href="#environment" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>You will need to <a class="reference external" href="https://help.github.com/articles/set-up-git/">install and configure Git and GitHub</a></p></li>
<li><p>Have python 3 installed and as your default python. In case it is not, use a <a class="reference external" href="https://docs.python.org/3/library/venv.html">virtual environment</a></p></li>
<li><p>have a bash shell</p></li>
<li><p>have admin rights to create and drop PostgreSQL databases</p></li>
</ul>
</section>
<section id="qwat-architecture">
<h2><span class="section-number">6.1.3. </span>QWAT architecture<a class="headerlink" href="#qwat-architecture" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Describe here various parts of QWAT</p></li>
<li><p>Describe relation to other projects (plugins, qgis core)</p></li>
</ul>
</section>
<section id="roles">
<h2><span class="section-number">6.1.4. </span>Roles<a class="headerlink" href="#roles" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><em>Commiters</em> have access to QWAT code repositories and can push to them. It means they control the evolution of the software</p></li>
<li><p><em>contributors</em> can provide information, code, documentation to the project. They do not have direct access for modifications and must go through the <em>commiters</em> to get their modifications applied. See the [[Contributors_guide]] for more information and processes.</p></li>
<li><p>The <em>release manager</em> is in charge of deciding when a new version of the software is published, and to actually publish the release. Current release manager is <a class="reference external" href="https://github.com/haubourg">Régis Haubourg (OSLANDIA)</a> on behalf of the QWAT’s group.</p></li>
</ul>
</section>
<section id="release-cycles-and-versioning">
<h2><span class="section-number">6.1.5. </span>Release cycles and versioning<a class="headerlink" href="#release-cycles-and-versioning" title="Permalink to this heading"></a></h2>
<p>New releases for QWAT are published on a regular basis, but non-fixed frequency. The <em>release manager</em> decides when a new version is published.</p>
<p>You can find the installed version number in the data model, in the <cite>qwat_sys.info</cite> table.</p>
<section id="version-and-release-management-policy">
<h3><span class="section-number">6.1.5.1. </span>Version and release management policy<a class="headerlink" href="#version-and-release-management-policy" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Version numbers follows the <a class="reference external" href="http://semver.org">semantic versioning approach</a>.</p></li>
<li><p>Version Roadmap for new features must be shared on the tracker and with the general committee. Issues must be opened and tagged using labels (1.4 , 1.5).</p></li>
<li><p>Do not create a version for each code change.</p></li>
<li><p>Versions will group different code change and must be discussed with the released manager.</p></li>
<li><p>It is possible to multiple Delta files for one <em>version-release</em> Ex: <cite>delta_1.3.2_0001_one_change</cite>, <cite>delta_1.3.2_0002_another_change</cite></p></li>
<li><p>Each new version will systematically have a release. A release is materialized by a git tag</p></li>
<li><p>travis-CI automatically deploys a release when the tag is pushed AND the tests succeed</p></li>
<li><p>Data administrators must NEVER work on master branch, but use release. The rationale behind that is that the latest version in master branch changes until the release, so it is not a reliable version tag . This means for git user they ahve to fetch remote tags and checkout to the desired release using git checkout tag_number</p></li>
</ul>
</section>
</section>
<section id="release-process">
<h2><span class="section-number">6.1.6. </span>Release process<a class="headerlink" href="#release-process" title="Permalink to this heading"></a></h2>
<p>The release process for QWAT is the following :</p>
<ul class="simple">
<li><p>Issues are triaged with milestones for next versions</p></li>
<li><p>The <em>release manager</em> decides when the next release will be made, in accordance with the community needs</p></li>
<li><p>He announces the estimated release date in advance (at least 1 week)</p></li>
<li><p>Issues are re-triaged and the date can be moved according to how the work progresses</p></li>
<li><p>CHANGES.md is checked to be sure that it contains a description of changes for this version</p></li>
<li><p>When ready (all due tickets closed), the <em>release manager</em> add version metadata to the project and tags the project(s) to release (data model, QWAT project) with the new version,</p></li>
<li><p>The <em>release manager</em> announces the new version (mailing lists, IRC, twitter…)</p></li>
</ul>
</section>
<section id="additional-dependencies">
<h2><span class="section-number">6.1.7. </span>Additional dependencies<a class="headerlink" href="#additional-dependencies" title="Permalink to this heading"></a></h2>
<p>QWAT Project has several dependencies on different submodules</p>
<ul class="simple">
<li><p>Fetching their content is achieved with a specific git command</p></li>
</ul>
</section>
<section id="versioning-your-extensions">
<h2><span class="section-number">6.1.8. </span>Versioning your extensions<a class="headerlink" href="#versioning-your-extensions" title="Permalink to this heading"></a></h2>
<p>Before QWAT 1.3.0 data model, version was tracked in the qwat_sys.versions that contributors had to maintain manually.
After that PUM module is taking care of raising and keeping track of versions automatically using core delta file naming convention.
However, we recommend using only one customization SQL script, with no version in its name. You can version it in a separate git or SVN repository, but mixing local and core version might lead to a very complex system.</p>
</section>
<section id="developing-the-core-data-model">
<h2><span class="section-number">6.1.9. </span>Developing the core data model<a class="headerlink" href="#developing-the-core-data-model" title="Permalink to this heading"></a></h2>
<p>To keep a controlled process over versioning, we have the following system :</p>
<ul class="simple">
<li><p>The SQL files corresponding to the creation of the core data model</p></li>
<li><p>SQL files corresponding to the modifications from version X to version X+1 (“diff SQL”)</p></li>
</ul>
<p>Diff files are located in the repository in the “delta” directory. Their name has this convention, which is used by PUM module :</p>
<ul class="simple">
<li><p><cite>delta_1.3.2_0001_one_change.sql</cite></p></li>
</ul>
<p>Deploying a model for a specific version and applying the diff files successively to reach another version should lead to the exact same model as deploying this latter version. The QWAT project will have tools to test for this compliance.</p>
<p>It is advised to write the diff files at the same time as the model modification, but this is not mandatory. Diff files <em>must</em> be complete and uptodate when a new model version is released.
Before releasing a new model version, the diff files should therefore be analyzed and completed. Some code can also be refactored to simplify the diff files (e.g. multiple modification to the same field between two version)</p>
<p>Some delta file are simple, like new tables and views. Some are more more complex since they are exposed via views. Most views in QWAT are autogenerated by the meta-project module.
That means that adding user fields (in elements or pipes for instance), will require additional instructions to drop and recreate the views before / after applying you delta file.
PUM allows to add pre and post files, either in python or sql for each update, see delta.1.2.8 for exemples.</p>
<p>As a consequence, when developing the core data model, you should :</p>
<ul class="simple">
<li><p>Put your modifications to the core model SQL files</p></li>
<li><p>Add your modifications to the correct diff file.</p></li>
</ul>
<p>Your pull request should be complete with these elements, or you have to be ready to review the diff SQL files before the release to ensure that the diff are uptodate.</p>
</section>
<section id="developing-a-qgis-project">
<h2><span class="section-number">6.1.10. </span>Developing a QGIS project<a class="headerlink" href="#developing-a-qgis-project" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>How to modify default project or create a new one</p></li>
<li><p>How to share these modifications</p></li>
</ul>
</section>
<section id="adding-new-features-to-qwat">
<h2><span class="section-number">6.1.11. </span>Adding new features to QWAT<a class="headerlink" href="#adding-new-features-to-qwat" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>see contributor’s guide for discussion process &amp; issue management</p></li>
<li><p>creating a specific plugin</p></li>
<li><p>contributing to QGIS core</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="6. Developer’s guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="local_customizations.html" class="btn btn-neutral float-right" title="6.2. Customize local DB models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, QWAT team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>